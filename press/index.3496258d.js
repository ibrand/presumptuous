let e,t;const s=document.createElement("div");s.classList.add("proseplay-window");const i=document.createElement("div");i.classList.add("proseplay-list"),s.append(i);const o=document.createElement("sup");o.classList.add("proseplay-link-ref");const n={x:0,y:0};class l{links=[];horizontal=!1;constructor(t){this.el=s.cloneNode(!0),t.appendChild(this.el),this.el.addEventListener("pointerover",this.handlePointerOver),this.el.addEventListener("pointerdown",this.handlePointerDown),this.el.addEventListener("pointermove",this.handlePointerMove),this.el.addEventListener("pointerup",this.handlePointerUp),this.el.addEventListener("pointerout",this.handlePointerOut),this.listEl=this.el.querySelector(".proseplay-list"),this.choices=[],this.currentIndex=0,this.isHoverable=!0,this.isDragged=!1,this.linkIndex=null,this.functionNames=[],this.functions={},e=.3*parseInt(getComputedStyle(t).fontSize)}setHorizontal(){this.horizontal=!0,this.el.classList.add("proseplay-horizontal")}addChoice(e){this.choices.push(e),this.listEl.appendChild(e.el)}activateChoice(t){t||(t=this.choices[this.currentIndex],this.horizontal?this.listEl.style.left=`${-Math.abs(t.offsetLeft)+e}px`:this.listEl.style.top=`-${t.offsetTop}px`),this.currentIndex=this.choices.indexOf(t),this.choices.forEach(e=>e.deactivate()),t.activate(),this.el.style.width=`${t.offsetWidth}px`}random(){return Math.floor(Math.random()*this.choices.length)}slideToPos(e){this.horizontal?this.listEl.style.left=`${e}px`:this.listEl.style.top=`${e}px`;let t=this.getNearestChoice(e);t&&this.activateChoice(t)}slideToChoice(t,s){if(t>this.choices.length-1)return;let i=this.choices[t];this.pointerOver(),this.pointerDown(),this.listEl.classList.add("proseplay-has-transition"),this.listEl.addEventListener("transitionend",e=>{e.target===this.listEl&&this.listEl.classList.remove("proseplay-has-transition")}),s&&(this.listEl.style.transitionDuration=`${s}ms`,this.listEl.addEventListener("transitionend",()=>{this.listEl.style.removeProperty("transition-duration")}),this.choices.forEach(e=>{e.el.style.transitionDuration=`${s}ms`,e.el.addEventListener("transitionend",()=>{e.el.style.removeProperty("transition-duration")})}),this.el.style.transitionDuration=`${s}ms`,this.el.addEventListener("transitionend",()=>{this.el.style.removeProperty("transition-duration")})),setTimeout(()=>{this.horizontal?this.listEl.style.left=`${-Math.abs(i.offsetLeft)+e}px`:this.listEl.style.top=`-${i.offsetTop}px`},15),this.pointerUp(),this.pointerOut(),this.activateChoice(i)}getNearestChoice(t){let s=1/0,i=null;return this.choices.forEach(o=>{let n=this.horizontal?Math.abs(t+o.offsetLeft-e):Math.abs(t+o.offsetTop);n<s&&(s=n,i=o)}),i}snapToNearestChoice(){let t=this.getNearestChoice(this.pos);t&&(this.horizontal?this.listEl.style.left=`${-Math.abs(t.offsetLeft)+e}px`:this.listEl.style.top=`-${t.offsetTop}px`)}get pos(){let e=this.horizontal?"left":"top";return parseInt(getComputedStyle(this.listEl).getPropertyValue(e).replace("px",""))}handlePointerOver=e=>{e.preventDefault(),this.isHoverable&&e.target.classList.contains("proseplay-current")&&(this.el.closest(".proseplay").querySelectorAll(".proseplay-line").forEach(e=>{e.classList.add("proseplay-has-hover")}),this.pointerOver())};pointerOver(){this.el.classList.add("proseplay-hover")}handlePointerDown=e=>{e.preventDefault(),this.isHoverable&&e.target.classList.contains("proseplay-current")&&(this.el.setPointerCapture(e.pointerId),this.links.forEach(e=>e.pointerDown()),this.isDragged=!0,n.x=e.clientX,n.y=e.clientY)};pointerDown(){this.el.classList.add("proseplay-hover")}handlePointerMove=e=>{if(e.preventDefault(),!this.isDragged)return;let t=this.horizontal?n.x-e.clientX:n.y-e.clientY;this.slideToPos(this.pos-t),this.links.forEach(e=>{e.slideToPos(this.pos-t)}),n.x=e.clientX,n.y=e.clientY};handlePointerOut=()=>{this.isDragged||(this.el.closest(".proseplay").querySelectorAll(".proseplay-line").forEach(e=>{e.classList.remove("proseplay-has-hover")}),this.pointerOut(),this.links.forEach(e=>e.pointerOut()))};pointerOut(){this.isDragged=!1,this.el.classList.remove("proseplay-hover")}handlePointerUp=e=>{e.preventDefault(),this.pointerUp(),this.links.forEach(e=>e.pointerUp())};pointerUp(){this.snapToNearestChoice(),this.isDragged=!1,this.el.classList.remove("proseplay-hover");let e=this.functionNames[this.currentIndex];e&&this.functions[e]&&this.functions[e](),this.el.closest(".proseplay").querySelectorAll(".proseplay-line").forEach(e=>{e.classList.remove("proseplay-has-hover")})}setLink(e,t){if(this.linkIndex=e,e){let t=o.cloneNode(!0);this.el.insertAdjacentElement("afterend",t),t.innerText=`${e}`}this.links=t}setFunctionNames(e){this.functionNames=e}setFunction(e,t){this.functions[e]=t}}const r=document.createElement("div");r.classList.add("proseplay-choice");class h{text="";isCurrent=!1;constructor(e){this.text=e,this.el=r.cloneNode(!0)," "!==e?this.el.innerText=e:this.el.innerHTML="&thinsp;"}activate(){this.isCurrent=!0,this.el.classList.add("proseplay-current")}deactivate(){this.isCurrent=!1,this.el.classList.remove("proseplay-current")}get offsetTop(){return this.el.offsetTop}get offsetLeft(){return this.el.offsetLeft}get offsetWidth(){return this.el.offsetWidth}}const a=document.createElement("div");a.classList.add("proseplay-line");const c={dickinson:`We talked with each other about each other
Though neither of us spoke \u{2014}
We were (too engrossed with|listening to) the Second\u{2019}s Races
And the Hoofs of the Clock \u{2014}
Pausing in Front of our (Sentenced Faces|Foundering Faces)
(Time\u{2019}s Decision shook \u{2014}|Time compassion Took)
Arks of Reprieve he offered to us \u{2014}
Ararats \u{2014} we took \u{2014}`,homophones:`in the (mist|missed) (see|sea)
(prey|pray) in the (morning|mourning)
for (words|worlds) that (exit|exist)
as (seep|sleep)`,hypothetically:`(hypothetically|hello)[1-]
(what if|i said)[1-]
(we fell|and held)[1-]
(in love|till death)[1-]`};class d{lines=[];windows=[];links=[];_isExpanded=!1;functions={};constructor(e){this.el=e,this.el.classList.add("proseplay"),window.addEventListener("resize",this.handleResize),document.addEventListener("DOMContentLoaded",this.handleResize),t=parseInt(getComputedStyle(e).fontSize)}static createInstance(){let e=document.createElement("div");return e.classList.add("proseplay"),document.body.appendChild(e),new d(e)}load(e){return this.lines=[],this.windows=[],this.links=[],this.parse(c[e])}static load(e){return d.createInstance().load(e)}parse(e){this.lines=[],this.windows=[],this.links=[];let t=[];return(e=e.trim()).split("\n").forEach(e=>{let s=[],i=e.matchAll(RegExp("\\(([^(|)]+\\|([^(|)]+\\|?)+)\\)(\\[(\\d)*(-)?\\])?","g")),o=0;for(let t of i){let i=t.index,n="\\"===e[i-2],l={strings:[]},r={strings:[]};n?(l.strings=[e.slice(o,i-1)],r.strings=[e.slice(i,i+t[0].length)]):(l.strings=[e.slice(o,i)],r.strings=t[1].split("|"),r.strings.forEach((e,t)=>{let[s,i]=e.split("->");i&&(r.functionNames||(r.functionNames=[]),r.functionNames[t]=i,r.strings[t]=s)}),t[4]&&(r.linkIndex=parseInt(t[4])),t[5]&&("|"===t[5]||"-"===t[5])&&(r.horizontal="-"===t[5])),s.push(l),s.push(r),o=i+t[0].length}o<e.length&&s.push({strings:[e.slice(o)]}),t.push(s)}),this.constructText(t),this}static parse(e){let t=d.createInstance();return t.parse(e),t}constructText(e){this.el.innerHTML="",e.forEach(e=>{let t=a.cloneNode(!0);this.el.appendChild(t),this.lines.push({el:t,tokens:[],windows:[]}),e.forEach(e=>{if(1===e.strings.length){let s=document.createElement("span");s.classList.add("proseplay-plaintext"),s.innerText=e.strings[0],t.append(s),this.lines[this.lines.length-1].tokens.push(e.strings[0])}else{let s=new l(t);for(let t in e.linkIndex&&(this.links[e.linkIndex]||(this.links[e.linkIndex]=[]),this.links[e.linkIndex].push(s)),e.functionNames&&s.setFunctionNames(e.functionNames),this.functions)s.setFunction(t,this.functions[t]);e.horizontal&&s.setHorizontal(),this.lines[this.lines.length-1].tokens.push(s),this.lines[this.lines.length-1].windows.push(s),this.windows.push(s),e.strings.forEach(e=>s.addChoice(new h(e))),s.activateChoice(s.choices[0])}}),0===e.length&&(t.innerHTML="&nbsp;")}),this.links.forEach((e,t)=>{e.forEach(s=>{let i=e.filter(e=>e!==s);s.setLink(t,i)})})}randomise(e){if(this._isExpanded)return;let t=e?.windowIndexes||this.windows.map((e,t)=>t),s=[];t.forEach(t=>{let i=this.windows[t];if(!i||s.includes(i))return;let o=i.random();i.slideToChoice(o,e?.millis),s.push(i),i.linkIndex&&this.links[i.linkIndex].forEach(t=>{s.includes(t)||(t.slideToChoice(o,e?.millis),s.push(t))})})}randomize(e){this.randomise(e)}expand(){this._isExpanded=!0,this.el.classList.toggle("proseplay-is-expanded",this._isExpanded);let e=parseFloat(getComputedStyle(this.el).fontSize);this.lines.forEach(s=>{let i=0;s.windows.forEach(s=>{let o=s.el.scrollHeight-s.listEl.offsetTop;s.el.style.height=`${o}px`;let n=s.el.scrollHeight-(s.currentIndex+1)*1.25*e-.06*e;s.el.style.top=`${n}px`,s.el.style.marginTop=`${-n}px`,i=Math.max(i,n),s.listEl.style.top="0px";let l=0;s.choices.forEach((e,i)=>{e.el.style.opacity="1",s.horizontal?(i>0&&(l+=t),l+=e.el.offsetWidth):l=Math.max(l,e.el.offsetWidth)}),s.el.style.width=`${l}px`,s.isHoverable=!1}),s.el.style.marginBottom=`${i}px`})}collapse(){this._isExpanded=!1,this.el.classList.toggle("proseplay-is-expanded",this._isExpanded),this.lines.forEach(e=>{e.el.style.removeProperty("margin-bottom"),e.windows.forEach(e=>{e.el.style.removeProperty("height"),e.el.style.removeProperty("top"),e.el.style.removeProperty("margin-top"),e.listEl.style.removeProperty("top"),e.choices.forEach(e=>{e.el.style.removeProperty("opacity")}),e.listEl.style.removeProperty("width"),e.isHoverable=!0,e.activateChoice()})})}get isExpanded(){return this._isExpanded}snapshot(){let e="";return this.lines.forEach(t=>{t.tokens.forEach(t=>{t instanceof l?e+=t.choices[t.currentIndex].text:e+=t}),e+="\n"}),e}setFunction(e,t){this.functions[e]=t,this.windows.forEach(s=>s.setFunction(e,t))}handleResize=()=>{this.windows.forEach(e=>e.activateChoice())};get choices(){return this.windows.map(e=>e.choices.map(e=>e.text))}get currentIndexes(){return this.windows.map(e=>e.currentIndex)}slideWindow(e,t,s){if(e>this.windows.length-1)return;let i=this.windows[e];t>i.choices.length-1||i.slideToChoice(t,s?.millis)}}const p=`Press(ure|ing juice| |ume)[1]


(Absently|Anxiously| |Patiently)[1] waiting for (cracks to show through|you to come through.| |me to come to)[1]

(Pressure creates the environment for the rarest jewels|Pressing distances me from you| |Presume that we each had a story that was true)[1]
(but I was long checked out of our hotel room|but fuck it I set the table for two| |that sometimes it takes years for softness to bloom)[1]

(Pl| Oranges fall to the ground as I rel| |Back then, I folded flower after flower, found myself in each cr)[1]ease (Do Not Disturb| | | e)[1]`;new d(document.querySelector(".text")).parse(p);
//# sourceMappingURL=index.3496258d.js.map
